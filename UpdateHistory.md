# 更新历史
这个文件是拿来记录更新日志的，但是不一定有提交记录描述得详细

## 更新日志

### v1.6.5
- 优化了切换角色后预览图刷新较慢的问题
- 简化代码
- 修复了一些预览不能正确刷新的bug
- 修复了切换配置后背景预加载错误的bug

### v1.6.4
- 增加了剪切模式的设置
- 修改了关于窗口的样子
- 重制了样式编辑页面
- 添加了背景和角色图层的编辑
- 修复了压缩功能不工作的bug
- 优化了一些性能问题
- 给样式编辑添加了重置按钮

### v1.6.3
- 优化了生成预览图时的性能问题
- 重做了样式编辑页面，优化了一些性能问题

### v1.6.2
- 添加了背景图缓存的宽度设置
- 添加了粘贴图片内容的位置设置
- 修复了压缩图片无视启用情况的bug

### v1.6.1
- 添加了阴影与文本区的样式编辑选项
- 字体现在不限格式了
- 移除了文本区的文本偏移设置
- 修复了移动图层顺序时的窗口重置问题
- 添加了预加载设置

### v1.6.0
- 更新了样式编辑功能
- 将部常规设置换到了新的位置
- 大幅调整了图片绘制逻辑
- 默认字体换为思源宋体 Bold

### v1.5
- 提升图片合成性能（大概省了150ms左右？）
- 采用纯本地方式绘制emoji，大幅提升效率（从几百ms降至100ms以内）
- 移除了部分强调字符(英文单引号，括号等)
- 目前可以同时粘贴文字和图片上去了（仅测试了qq和微信环境）
- 合并简化了代码
- 将使用keyboard模块的部分全数换为了pynput
- 默认不显示情感匹配模块
- 重做了角色图片的绘制部分
- 背景和角色图片现在都支持多种格式了
- 使用了 Existence 修复的角色立绘
- 添加了情感筛选功能，可以选择只显示指定情感的表情
- 修复了以下bug：
  + exe程序读取不到文件的bug
  + 不能把图片粘贴上去的bug
  + 修复了settings.yml文件不存在会导致程序奔溃的bug

### v1.4
- 改为使用openai模块与ai通信
- 修复了ai模型切换时可能出现的bug
- 标注了部分角色差分的情感，但是我个木头脑袋感觉出来的不一定准，有没有人能帮帮我（
- 新增了白名单进程编辑功能，增加了快捷键编辑功能（大概有潜在bug）
- 把压缩移到合成文字阶段处理，小幅提高了合成速度
- 移除白名单管理页下面的两个按钮
- 添加了快捷键编辑的按键校验功能
- 添加了字体颜色和强调颜色设置功能
- 代码精简，性能优化
- release已发布
- 修复了以下bug：
  + 修复了ai匹配的表情不存在时可能会使用固定表情的bug
  + 关闭情感匹配后，预览图能正常根据表情配置正常刷新了
  + 修正了生成图片消息显示存在的一点问题
  + 修了一下按键检测在中文输入法的输入途中可能发生的bug
  + 修复了暂停监听快捷键无法重新启用按键监听的bug
  + 移除了白名单进程页下面的两个按钮
  + 修复了快捷键每次保存设置都重载的问题
  + 生成图片事件会在按键释放后执行，防止因为有按键未释放导致剪切失败
  + 修复了切换角色时表情索引不存在的问题
  + 修复了ai模型的配置读取bug
  + 修复了调整窗口大小会刷新预览图的bug
  + 修复了强调文本的着色和匹配问题

### v1.3

- 新增了快捷切换人物背景的热键（含六个可自定义的快捷角色切换位、上下切换表情/背景/角色的键位以及），但是目前修改键位需要在keymap.yml里改
- 新增了暂停和启用按键监听的热键，默认为ctrl+alt+p
- 添加了自定义字体的功能（字体文件需要放在assets/font文件夹中），字体大小也可以在设置中自定义
- 添加了图像压缩功能（因为剪贴板的特性，所以是直接削减像素压缩）
- 减少了不必要的copy操作来提升图像合成性能
- 添加了表情自动匹配功能，可以用deepseek或者在ollama上运行的模型来分析文本情感
- 修复了以下bug：
  + emoji绘制功能已修复，初次绘制的emoji可能需要联网获取图像
  + 修复了合成图片时的多线程导致的性能问题

### v1.2

- 直接把fork来的项目扔给ai重做了
- 给随机功能添加了开关
- 移除了预合成功能，改为实时预览，并直接在预览图的基础上合成最后的文字
- 添加了图片预览功能（会预览下一个发送的图片的样子，即使是随机生成）
- 精简了部分代码（指删了部分ai写的意义不明的操作）
- 切换人物时自动释放内存中缓存的图片
- 修复了以下bug：
  + 程序最小化后有概率无法正常监听按键
  + 修复了预览不正常的bug，现在可以正常预览了

### v1.1.5

- 增添了自主切换表情功能
- 将特殊字体改为红色

## To-Do List
1. 程序界面外观优化? (v1.6)
2. 性能优化

## BUG记录
1. 强调字符只有半边时着色有问题（暂时没想着修）
2. 复杂的组合emoji无法正常显示，比如 👨‍👩‍👧‍👦 👨🏻‍👩🏼‍👧🏽‍👦🏾
3. 快捷键编辑页无法用滚轮滚动
4. 在打开子窗口的情况下最小化所有窗口会无法恢复